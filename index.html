<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CONSIA</title>
  <style>
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Inter,Arial;background:#0b0f14;color:#eaf2ff;display:flex;min-height:100vh;align-items:center;justify-content:center}
    .shell{width:min(760px,92vw);text-align:center}
    .card{margin:0 auto;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10);border-radius:18px;padding:26px;box-shadow:0 20px 80px rgba(0,0,0,.55)}
    h1{margin:0;font-size:26px;letter-spacing:.2px}
    .sub{margin-top:6px;opacity:.85}
    .btn{margin-top:18px;width:min(520px,100%);border:0;border-radius:14px;padding:16px;font-size:16px;font-weight:800;background:#3b82f6;color:#05101f;cursor:pointer}
    .btn:active{transform:scale(.99)}
    .row{margin-top:14px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .chip{font-size:12px;opacity:.8;border:1px solid rgba(255,255,255,.12);padding:6px 10px;border-radius:999px}
    .panel{margin-top:16px;background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.10);border-radius:14px;padding:14px;text-align:left;white-space:pre-wrap}
    .link{color:#93c5fd;text-decoration:none}
  </style>
</head>
<body>
  <div class="shell">
    <div class="card">
      <h1>CONSIA</h1>
      <div class="sub">Sistema activo · Owner Only</div>

      <button class="btn" id="run">Sistema operativo</button>

      <div class="row">
        <div class="chip">API: https://api.consia.world/api/chat</div>
        <div class="chip"><a class="link" href="https://api.consia.world/demo" target="_blank" rel="noreferrer">Demo pública</a></div>
        <div class="chip" id="tokState">Token: no cargado</div>
      </div>

      <div class="panel" id="log">Listo.</div>
    </div>
  </div>

<script>
const API = "https://api.consia.world/api/chat";
const KEY = "CONSIA_OWNER_TOKEN_LOCAL";
const log = (t)=> document.getElementById('log').textContent = t;

function tokenLoaded(){
  const t = localStorage.getItem(KEY);
  document.getElementById('tokState').textContent = t ? "Token: cargado" : "Token: no cargado";
  return t || "";
}

async function ensureToken(){
  let t = tokenLoaded();
  if(!t){
    t = prompt("Pegá tu CONSIA Owner Token (x-consia-owner):","");
    if(t && t.trim()){
      localStorage.setItem(KEY, t.trim());
      tokenLoaded();
    }
  }
  return (localStorage.getItem(KEY) || "").trim();
}

document.getElementById('run').addEventListener('click', async ()=>{
  const token = await ensureToken();
  if(!token){ log("Sin token."); return; }

  log("Conectando...");
  try{
    const r = await fetch(API, {
      method:"POST",
      headers:{
        "content-type":"application/json",
        "x-consia-owner": token
      },
      body: JSON.stringify({
        input: "Estado del sistema",
        mode: "CORE",
        region: "auto",
        conversation: true
      })
    });

    const j = await r.json().catch(()=> ({}));
    if(!r.ok){
      log("HTTP "+r.status+"\n"+JSON.stringify(j,null,2));
      return;
    }
    log(j.reply ? j.reply : JSON.stringify(j,null,2));
  }catch(e){
    log("Error: "+(e && e.message ? e.message : e));
  }
});

tokenLoaded();
</script>
</body>
</html>
